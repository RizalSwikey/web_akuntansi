{% load static %}

<!-- This sidebar now requires the 'completion_status' object from the view -->
<aside id="sidebar" class="bg-[#636CCB] text-white w-72 [&.collapsed]:w-24 min-h-screen p-6 flex flex-col justify-between transition-all duration-300 relative group">
  <div>
    <!-- Logo and Menu -->
    <div class="flex items-center justify-between pb-6 border-b border-gray-500">
        <div class="flex items-center gap-4">
          <strong class="group-[.collapsed]:hidden text-2xl">JurnalKita</strong>
        </div>
        <button id="menu-toggle-btn" data-flowbite-ignore class="text-white p-2 rounded-md hover:bg-[#50589C]">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 transition-transform duration-300">
    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
  </svg>
</button>
    </div>
    
    <nav class="mt-8">
      <ul class="space-y-4" text-xl>
        
        <!-- 1. Profile (Always Visible) -->
        <li>
          <a href="{% url 'core:profile' %}" class="flex items-center gap-4 py-3 px-4 rounded-lg {% if request.resolver_match.url_name == 'profile' %}bg-[#50589C] font-semibold{% else %}hover:bg-[#50589C]{% endif %}">
            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21" /></svg>
            <span class="group-[.collapsed]:hidden">1. Profile perusahaan</span>
          </a>
        </li>
        
        <!-- 2. Pendapatan (Visible if Profile is complete) -->
        {% if completion_status.profile %}
        <li>
          <a href="{% url 'core:pendapatan' %}" class="flex items-center gap-4 py-3 px-4 rounded-lg {% if request.resolver_match.url_name == 'pendapatan' %}bg-[#50589C] font-semibold{% else %}hover:bg-[#50589C]{% endif %}">
            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h12A2.25 2.25 0 0 0 20.25 14.25V3M3.75 3H13.5m0 0v11.25m0 0A2.25 2.25 0 0 1 15.75 16.5h5.25A2.25 2.25 0 0 0 23.25 14.25V3M13.5 3H21" /></svg>
            <span class="group-[.collapsed]:hidden">2. Pendapatan</span>
          </a>
        </li>
        {% endif %}
        
        <!-- 3. HPP (Visible if Pendapatan is complete) -->
        {% if completion_status.pendapatan %}
        <li>
          <a href="{% url 'core:hpp' %}" class="flex items-center gap-4 py-3 px-4 rounded-lg {% if request.resolver_match.url_name == 'hpp' %}bg-[#50589C] font-semibold{% else %}hover:bg-[#50589C]{% endif %}">
            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10.5 11.25h3M12 15V3.75" /></svg>
            <span class="group-[.collapsed]:hidden">3. Harga pokok produksi</span>
          </a>
        </li>
        {% endif %}
        
        <!-- 4. Beban Usaha (Visible if HPP is complete) -->
        {% if completion_status.hpp %}
        <li>
          <a href="{% url 'core:beban_usaha' %}" class="flex items-center gap-4 py-3 px-4 rounded-lg {% if request.resolver_match.url_name == 'beban_usaha' %}bg-[#50589C] font-semibold{% else %}hover:bg-[#50589C]{% endif %}">
            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.75A.75.75 0 0 1 3 4.5h.75m0 0H21m-18 6v.75A.75.75 0 0 1 3 12h-.75m0 0v-.75A.75.75 0 0 1 3 10.5h.75m0 0H21m-18 6v.75A.75.75 0 0 1 3 18h-.75m0 0v-.75A.75.75 0 0 1 3 16.5h.75m0 0H21" /></svg>
            <span class="group-[.collapsed]:hidden">4. Beban usaha</span>
          </a>
        </li>
        {% endif %}
        
        <!-- 5. Laporan (Visible if HPP is complete) -->
        {% if completion_status.hpp %}
        <li>
          <a href="{% url 'core:laporan' %}" class="flex items-center gap-4 py-3 px-4 rounded-lg {% if request.resolver_match.url_name == 'laporan' %}bg-[#50589C] font-semibold{% else %}hover:bg-[#50589C]{% endif %}">
            <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
            <span class="group-[.collapsed]:hidden">5. Laporan laba rugi</span>
          </a>
        </li>
        {% endif %}

      </ul>
    </nav>
  </div>
  <a href="{% url 'core:logout' %}" class="w-full py-4 bg-[#B02A43] font-semibold rounded-lg hover:bg-[#96243A] flex items-center justify-center gap-4">
  <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75" /></svg>
  <span class="group-[.collapsed]:hidden">Logout</span>
</a>
</aside>

<!-- This script is for the sidebar toggle -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const menuToggleBtn = document.getElementById("menu-toggle-btn");
    const sidebar = document.getElementById("sidebar");

    if (menuToggleBtn && sidebar) {
      menuToggleBtn.addEventListener("click", () =>
        sidebar.classList.toggle("collapsed")
      );
    }
  });
</script>